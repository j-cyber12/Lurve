(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{5297:(e,r,i)=>{Promise.resolve().then(i.bind(i,9727))},9727:(e,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>d,dynamic:()=>s});var t=i(5155),a=i(2115);let s="force-dynamic";function d(){let[e,r]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[d,n]=(0,a.useState)("name-asc"),[l,c]=(0,a.useState)(""),[o,m]=(0,a.useState)(""),[u,x]=(0,a.useState)(!1),[p,b]=(0,a.useState)(null),[h,g]=(0,a.useState)({id:"",name:"",price:"",description:"",gender:"",category:""}),[f,v]=(0,a.useState)([]),[j,y]=(0,a.useState)(null),[N,k]=(0,a.useState)([]),[w,z]=(0,a.useState)(""),[C,S]=(0,a.useState)(!1),[F,L]=(0,a.useState)(null),[U,P]=(0,a.useState)(null),R=e=>"undefined"!=typeof File&&e instanceof File,O=parseFloat(h.price||""),T=""!==h.price&&(Number.isNaN(O)||O<0)?"Enter a valid price":null,E=""===h.name.trim()?"Name is required":null,A=!!E||!!T;function D(e){L(e),setTimeout(()=>L(null),2e3)}let M=(0,a.useCallback)(async()=>{try{let e=await fetch("/api/products",{cache:"no-store"});if(!e.ok)throw Error("Failed to load");let i=await e.json();r(Array.isArray(i)?i:[])}catch(e){r([]),D("Could not load products")}},[]);(0,a.useEffect)(()=>{M()},[M]),(0,a.useEffect)(()=>{if(u&&"undefined"!=typeof document){let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}}},[u]);let _=(0,a.useMemo)(()=>{let r=i.trim().toLowerCase(),t=e.filter(e=>{let i=!r||e.name.toLowerCase().includes(r),t=!l||e.gender===l,a=!o||e.category===o;return i&&t&&a}),a=new Set;return(t=t.filter(e=>!a.has(e.id)&&(a.add(e.id),!0))).sort((e,r)=>"name-asc"===d?e.name.localeCompare(r.name):"price-asc"===d?e.price-r.price:r.price-e.price)},[e,i,d,l,o]);async function q(e){let r={name:"".concat(e.name," Copy"),price:e.price,thumbnail:e.thumbnail,images:e.images,videoUrl:e.videoUrl,sizes:e.sizes,gender:e.gender,category:e.category};(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok?(D("Product duplicated"),await M()):D("Failed to duplicate")}async function $(e){if(e.preventDefault(),!h.name||!h.price)return void D("Please fill required fields");S(!0);let r=f.filter(e=>R(e)),i=f.filter(e=>!R(e)),t=[];if(r.length){let e=new FormData;for(let i of r)e.append("files",i);let i=await fetch("/api/upload",{method:"POST",body:e});if(!i.ok){let e="";try{let r=await i.json();e=r&&(r.detail||r.error)||""}catch(e){}S(!1),D(e?"Image upload failed: ".concat(e):"Image upload failed");return}let{files:a}=await i.json();t=a}let a="string"==typeof j?j:"";if(j&&R(j)){let e=new FormData;e.append("files",j);let r=await fetch("/api/upload",{method:"POST",body:e});if(!r.ok){let e="";try{let i=await r.json();e=i&&(i.detail||i.error)||""}catch(e){}S(!1),D(e?"Video upload failed: ".concat(e):"Video upload failed");return}let{files:i}=await r.json();a=i[0]||""}let s=[...i,...t],d={id:h.id||void 0,name:h.name.trim(),price:parseFloat(h.price),thumbnail:s[0]||"/placeholder.svg",images:s,videoUrl:a,sizes:N,gender:h.gender||void 0,category:h.category||void 0},n=!1;n=p?(await fetch("/api/products/".concat(p),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok:(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok,S(!1),n?(x(!1),D("Saved"),await M()):D("Failed to save")}async function B(){if(!U)return;let e=await fetch("/api/products/".concat(U),{method:"DELETE"});P(null),e.ok?(D("Deleted"),await M()):D("Failed to delete")}let I=(0,a.useMemo)(()=>{if(!u)return null;let e=parseFloat(h.price||"0")||0;return{id:h.id||(h.name||"new").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),name:h.name||"Product Name",price:e,description:h.description||"Description preview",thumbnail:f[0]?"undefined"!=typeof File&&f[0]instanceof File&&"undefined"!=typeof URL?URL.createObjectURL(f[0]):f[0]:"/placeholder.svg",images:f.map(e=>"undefined"!=typeof File&&e instanceof File&&"undefined"!=typeof URL?URL.createObjectURL(e):e),videoUrl:j?"undefined"!=typeof File&&j instanceof File&&"undefined"!=typeof URL?URL.createObjectURL(j):j:"",sizes:N,gender:h.gender||void 0,category:h.category||void 0}},[h,f,j,N,u]),J=e.length;return(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-black tracking-tight",children:"Admin"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Manage products, images and videos"})]}),(0,t.jsx)("button",{onClick:function(){b(null),g({id:"",name:"",price:"",description:"",gender:"",category:""}),v([]),y(null),k([]),x(!0)},className:"px-4 py-2 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500 text-white font-medium shadow hover:opacity-90 transition-opacity",children:"Add Product"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-token p-4 surface",children:[(0,t.jsx)("div",{className:"text-xs uppercase text-zinc-500",children:"Total Products"}),(0,t.jsx)("div",{className:"text-2xl font-bold mt-1",children:J})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-token p-4 surface",children:[(0,t.jsx)("div",{className:"text-xs uppercase text-zinc-500",children:"Average Price"}),(0,t.jsxs)("div",{className:"text-2xl font-bold mt-1",children:["$",(J?e.reduce((e,r)=>e+r.price,0)/J:0).toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-zinc-300/80 dark:border-zinc-700/80 px-3 py-1.5 bg-white dark:bg-zinc-900 w-full sm:w-80",children:[(0,t.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"opacity-60",children:(0,t.jsx)("path",{d:"M21 21L15.8 15.8M18 10.5C18 14.0899 15.0899 17 11.5 17C7.91015 17 5 14.0899 5 10.5C5 6.91015 7.91015 4 11.5 4C15.0899 4 18 6.91015 18 10.5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,t.jsx)("input",{value:i,onChange:e=>s(e.target.value),placeholder:"Search products...",className:"bg-transparent outline-none flex-1"})]}),(0,t.jsxs)("select",{value:d,onChange:e=>n(e.target.value),className:"rounded-full border border-zinc-300 dark:border-zinc-700 bg-white dark:bg-zinc-900 px-3 py-1.5 text-sm",children:[(0,t.jsx)("option",{value:"name-asc",children:"Sort: Name"}),(0,t.jsx)("option",{value:"price-asc",children:"Sort: Price (Low → High)"}),(0,t.jsx)("option",{value:"price-desc",children:"Sort: Price (High → Low)"})]}),(0,t.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"rounded-full border border-zinc-300 dark:border-zinc-700 bg-white dark:bg-zinc-900 px-3 py-1.5 text-sm",children:[(0,t.jsx)("option",{value:"",children:"All Genders"}),(0,t.jsx)("option",{value:"men",children:"Men"}),(0,t.jsx)("option",{value:"women",children:"Women"}),(0,t.jsx)("option",{value:"unisex",children:"Unisex"})]}),(0,t.jsxs)("select",{value:o,onChange:e=>m(e.target.value),className:"rounded-full border border-zinc-300 dark:border-zinc-700 bg-white dark:bg-zinc-900 px-3 py-1.5 text-sm",children:[(0,t.jsx)("option",{value:"",children:"All Categories"}),(0,t.jsx)("option",{value:"shoes",children:"Shoes"}),(0,t.jsx)("option",{value:"bags",children:"Bags"})]})]}),0===_.length&&(0,t.jsxs)("div",{className:"rounded-xl border border-dashed border-zinc-300 dark:border-zinc-700 p-8 text-center text-zinc-500",children:["No products match your search or filters.",(0,t.jsx)("div",{className:"mt-3 flex flex-wrap items-center justify-center gap-2",children:(0,t.jsx)("button",{onClick:()=>{s(""),c(""),m("")},className:"px-3 py-1.5 rounded-full border border-zinc-300 dark:border-zinc-700",children:"Reset filters"})})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-5",children:_.map(e=>(0,t.jsxs)("div",{className:"rounded-xl overflow-hidden border border-token surface group hover-lift",children:[(0,t.jsx)("img",{src:e.thumbnail,alt:e.name,className:"w-full h-40 object-cover group-hover:scale-[1.02] transition-transform duration-300"}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"font-semibold",children:e.name||"(Untitled)"})}),(0,t.jsxs)("div",{className:"font-semibold",children:["$",Number.isFinite(Number(e.price))?Number(e.price).toFixed(2):"0.00"]})]}),(e.gender||e.category)&&(0,t.jsxs)("div",{className:"mt-2 flex gap-2 text-[11px]",children:[e.gender&&(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 uppercase tracking-wide",children:e.gender}),e.category&&(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 uppercase tracking-wide",children:e.category})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-4 text-sm",children:[(0,t.jsx)("button",{onClick:()=>{b(e.id),g({id:e.id,name:e.name,price:String(e.price),description:e.description,gender:e.gender||"",category:e.category||""}),v(e.images||[]),y(e.videoUrl||null),k(e.sizes||[]),x(!0)},className:"px-3 py-1.5 rounded-full border border-zinc-300 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-800",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>q(e),className:"px-3 py-1.5 rounded-full border border-zinc-300 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-800",children:"Duplicate"}),(0,t.jsx)("button",{onClick:()=>{P(e.id)},className:"ml-auto text-red-600 hover:text-red-700",children:"Delete"})]})]})]},e.id))}),u&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>x(!1)}),(0,t.jsxs)("div",{className:"relative w-full sm:max-w-4xl mx-0 sm:mx-4 sm:rounded-2xl border border-token surface overflow-hidden shadow-2xl h-[80vh] sm:h-auto max-h-[90vh] flex flex-col overscroll-contain",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-5 py-3 border-b border-zinc-200/70 dark:border-zinc-800/70",children:[(0,t.jsx)("div",{className:"font-semibold",children:p?"Edit Product":"Add Product"}),(0,t.jsx)("button",{onClick:()=>x(!1),className:"text-zinc-500 hover:text-zinc-700","aria-label":"Close",children:"\xd7"})]}),(0,t.jsxs)("div",{className:"grid sm:grid-cols-2 gap-0 overflow-y-auto min-h-0",children:[(0,t.jsxs)("form",{onSubmit:$,className:"p-5 space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsxs)("label",{className:"block text-sm mb-1",children:["Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{autoFocus:!0,value:h.name,onChange:e=>g({...h,name:e.target.value}),required:!0,"aria-invalid":!!E,"aria-describedby":E?"name-error":void 0,className:"w-full rounded-md border border-zinc-300 dark:border-zinc-700 bg-transparent px-4 py-3 text-base"}),E&&(0,t.jsx)("p",{id:"name-error",className:"mt-1 text-xs text-red-600",children:E})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm mb-1",children:["Price ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{value:h.price,onChange:e=>g({...h,price:e.target.value}),type:"number",inputMode:"decimal",step:"0.01",min:"0",placeholder:"0.00",required:!0,"aria-invalid":!!T,"aria-describedby":T?"price-error":void 0,className:"w-full rounded-md border border-zinc-300 dark:border-zinc-700 bg-transparent px-4 py-3 text-base"}),T&&(0,t.jsx)("p",{id:"price-error",className:"mt-1 text-xs text-red-600",children:T})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-1",children:"Gender"}),(0,t.jsxs)("select",{value:h.gender,onChange:e=>g({...h,gender:e.target.value}),className:"w-full rounded-md border border-zinc-300 dark:border-zinc-700 bg-transparent px-4 py-3 text-base",children:[(0,t.jsx)("option",{value:"",children:"— Select —"}),(0,t.jsx)("option",{value:"men",children:"Men"}),(0,t.jsx)("option",{value:"women",children:"Women"}),(0,t.jsx)("option",{value:"unisex",children:"Unisex"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-1",children:"Category"}),(0,t.jsxs)("select",{value:h.category,onChange:e=>g({...h,category:e.target.value}),className:"w-full rounded-md border border-zinc-300 dark:border-zinc-700 bg-transparent px-4 py-3 text-base",children:[(0,t.jsx)("option",{value:"",children:"— Select —"}),(0,t.jsx)("option",{value:"shoes",children:"Shoes"}),(0,t.jsx)("option",{value:"bags",children:"Bags"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-2",children:"Product Images"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[f.map((e,r)=>(0,t.jsxs)("div",{className:"relative group rounded-lg overflow-hidden border border-token elevated",children:[(0,t.jsx)("img",{src:"undefined"!=typeof File&&e instanceof File&&"undefined"!=typeof URL?URL.createObjectURL(e):e,alt:"img",className:"w-full h-24 object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>v(e=>e.filter((e,i)=>i!==r)),className:"absolute top-1 right-1 text-xs px-2 py-0.5 rounded-full bg-black/70 text-white opacity-80",children:"Remove"})]},r)),(0,t.jsxs)("label",{className:"flex items-center justify-center h-24 rounded-lg border border-dashed border-token text-zinc-500 cursor-pointer elevated",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:e=>{let r=Array.from(e.target.files||[]);r.length&&v(e=>[...e,...r]),e.currentTarget.value=""}}),(0,t.jsx)("span",{className:"text-2xl",children:"+"})]})]}),(0,t.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"First image becomes the thumbnail."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-2",children:"Product Video (optional)"}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:j?(0,t.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-token elevated",children:[(0,t.jsx)("video",{className:"w-40 h-24 object-cover",controls:!0,src:"undefined"!=typeof File&&j instanceof File&&"undefined"!=typeof URL?URL.createObjectURL(j):j}),(0,t.jsx)("button",{type:"button",onClick:()=>y(null),className:"absolute top-1 right-1 text-xs px-2 py-0.5 rounded-full bg-black/70 text-white opacity-80",children:"Remove"})]}):(0,t.jsxs)("label",{className:"flex items-center justify-center w-40 h-24 rounded-lg border border-dashed border-token text-zinc-500 cursor-pointer elevated",children:[(0,t.jsx)("input",{type:"file",accept:"video/*",className:"hidden",onChange:e=>{let r=(e.target.files||[])[0];r&&y(r),e.currentTarget.value=""}}),(0,t.jsx)("span",{className:"text-2xl",children:"+"})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-2",children:"Available Sizes"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:N.map((e,r)=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 text-sm",children:[e,(0,t.jsx)("button",{type:"button",onClick:()=>k(N.filter((e,i)=>i!==r)),className:"text-zinc-500 hover:text-zinc-700",children:"\xd7"})]},r))}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{value:w,onChange:e=>z(e.target.value),placeholder:"e.g., 7 or 42 EU",className:"flex-1 rounded-md border border-zinc-300 dark:border-zinc-700 bg-transparent px-4 py-3 text-base"}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e=w.trim();e&&(k(Array.from(new Set([...N,e]))),z(""))},className:"px-4 rounded-md border border-zinc-300 dark:border-zinc-700",children:"Add"})]})]}),(0,t.jsx)("div",{className:"sm:hidden sticky bottom-0 left-0 right-0 -mx-5 p-4 bg-white/90 dark:bg-zinc-900/90 backdrop-blur border-t border-zinc-200/70 dark:border-zinc-800/70",children:(0,t.jsx)("button",{disabled:C||A,className:"w-full inline-flex items-center justify-center px-4 py-3 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500 text-white font-medium shadow hover:opacity-90 transition-opacity disabled:opacity-50",children:C?"Saving…":"Save"})}),(0,t.jsxs)("div",{className:"hidden sm:flex items-center gap-3 pt-1",children:[(0,t.jsx)("button",{disabled:C||A,className:"inline-flex items-center justify-center px-4 py-2 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500 text-white font-medium shadow hover:opacity-90 transition-opacity disabled:opacity-50",children:C?"Saving…":"Save"}),p&&(0,t.jsx)("button",{type:"button",onClick:()=>{g({id:"",name:"",price:"",description:"",gender:"",category:""}),v([]),y(null)},className:"px-3 py-2 rounded-full border border-zinc-300 dark:border-zinc-700",children:"Clear"})]})]}),(0,t.jsxs)("div",{className:"p-5 border-t sm:border-t-0 sm:border-l border-zinc-200/70 dark:border-zinc-800/70 bg-zinc-50/60 dark:bg-zinc-950/40",children:[(0,t.jsx)("div",{className:"text-sm font-medium mb-3",children:"Live Preview"}),I&&(0,t.jsxs)("div",{className:"rounded-xl overflow-hidden border border-zinc-200/70 dark:border-zinc-800/70 bg-white dark:bg-zinc-900 max-w-sm",children:[(0,t.jsx)("img",{src:I.thumbnail,alt:"preview",className:"w-full h-44 object-cover"}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"font-semibold",children:I.name||"(Untitled)"}),(0,t.jsxs)("div",{className:"font-semibold",children:["$",Number.isFinite(Number(I.price))?Number(I.price).toFixed(2):"0.00"]})]}),(I.gender||I.category)&&(0,t.jsxs)("div",{className:"mt-2 flex gap-2 text-[11px]",children:[I.gender&&(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 uppercase tracking-wide",children:I.gender}),I.category&&(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 uppercase tracking-wide",children:I.category})]})]})]})]})]})]})]}),U&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>P(null)}),(0,t.jsxs)("div",{className:"relative w-full max-w-md mx-4 rounded-xl border border-zinc-200/70 dark:border-zinc-800/70 bg-white dark:bg-zinc-900 p-5",children:[(0,t.jsx)("div",{className:"text-lg font-semibold mb-2",children:"Delete product?"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"This action cannot be undone."}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-4",children:[(0,t.jsx)("button",{onClick:()=>P(null),className:"px-4 py-2 rounded-full border border-zinc-300 dark:border-zinc-700",children:"Cancel"}),(0,t.jsx)("button",{onClick:B,className:"px-4 py-2 rounded-full bg-red-600 text-white",children:"Delete"})]})]})]}),F&&(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50 px-4 py-2 rounded-full bg-black text-white shadow-lg",role:"status","aria-live":"polite",children:F})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=5297)),_N_E=e.O()}]);